# Single config file for training, gallery building, and inference

seed: 1337
rotate_by_direction: true
crop_ratio: 0.707

model:
  backbone: resnet50
  embedding_dim: 512
  use_length: true
  length_embed_dim: 32
  pretrained: true
  checkpoint: outputs/reid_model.pt

faiss:
  index_path: faiss_index/gallery.index
  metadata_path: faiss_index/gallery_metadata.json
  normalize: true

data:
  source: graphql  # "graphql" or "elasticsearch"
  fetch_days: 30
  train_csv: data/train.csv
  val_csv: data/val.csv
  gallery_csv: data/gallery.csv
  image_root: data/images
  image_size: 224
  num_workers: 8
  batch_size: 128
  use_length: true
  compute_length_stats: true
  length_mean: 221.2029
  length_std: 44.8894
  augment: true
  pk_sampler:
    enabled: true
    p: 8
    k: 8
    batches_per_epoch: 1000

train:
  epochs: 40
  lr: 0.0003
  weight_decay: 0.0001
  margin: 0.3
  loss: combined
  triplet_weight: 1.0
  triplet:
    distance: euclidean
    margin: 0.2
    softplus: true
  arcface_margin: 0.5
  arcface_scale: 30.0
  arcface_weight: 1.0
  log_every: 50
  output_dir: outputs
  checkpoint_name: reid_model.pt

query:
  similarity_threshold: 0.7
  top_k: 5
